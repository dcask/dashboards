[{"name":"YandexMapsMinimalCopy","lastEditorName":" demo","lastModified":"2023-03-20T16:15:33.851+03:00","background":{"type":0,"imageGuid":null,"color":"rgba(255,255,255,0)"},"sheets":[{"guid":"c45d8e3c2ac4416c975d0ef4358f7f1f","name":"Новый лист 1","position":0,"widgets":[{"html":"","controlPanel":{"enabled":false},"guid":"fb86e2c1d12f492e9d9271ea6028b307","type":"CustomWidget","position":{"x":0,"y":120},"positionLocked":true,"size":{"width":1920,"height":950},"title":{"enabled":false,"autoSize":null,"text":"YandexMapsMinimal","link":"","linkEnabled":null,"background":{"enabled":null,"color":{"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"textStyle":{"color":null,"fontSize":null,"fontFamily":null,"align":null,"verticalAlign":null,"lineHeight":null,"isBold":null,"isItalic":null},"size":{"width":null,"height":null}},"frame":{"enabled":null,"style":{"radius":null,"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"background":{"enabled":null,"color":{"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"boxShadow":{"x":null,"y":null,"blur":null,"spread":null,"color":null},"zIndex":1,"selectedFilterValues":{"values":[],"range":{"min":null,"max":null},"useRange":false,"useExcluding":false},"multiselectEnabled":true,"userChangedSelectedValuesInCurrentSession":false,"colorPalette":null,"useCustomColors":false,"drilldownEnabled":false,"allowedDatasourceType":[2,3,4,5,6],"codeEditableEnabled":true,"overriddenCode":"// Проверяем добавлена ли уже библиотека, и при необходимости добавляём её\nif (!document.getElementById('yaMaps')) {\n    let elem = document.createElement('script');\n    elem.src=\"https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey=<ваш API-ключ>\";\n    elem.type=\"text/javascript\";\n    elem.id = \"yaMaps\";\n    elem.onload = init;\n    document.head.append(elem) \n}\n\n//promise для корректного отображения preview\nvar loadHandler = null;\nvar loadedPromise = new Promise((resolve,reject)=>{\n            // resolve();//вызвать когда виджет отрисовался\n            loadHandler = resolve;\n        });\nsetTimeout(loadHandler, 2000)\n\nfunction init () {\n    ymaps.ready(function () {\n        console.log('Start')\n        var myMap = new ymaps.Map(w.general.renderTo, {\n            center: [49.894727575, 63.999817279],\n            zoom: 8,\n        });\n        \n        let myPlacemarks = [];\n        w.data.rows.forEach(function(item, index) {\n        myPlacemarks.push (new ymaps.Placemark([w.data.values[1][index], w.data.values[2][index]], {\n                // Чтобы балун и хинт открывались на метке, необходимо задать ей определенные свойства.\n                balloonContentHeader: item[0],\n                balloonContentBody: `${w.data.cols[0][0]}: <b>${w.data.values[0][index]}</b> штук`,\n                balloonContentFooter: `Координаты: ${w.data.values[1][index]}/${w.data.values[2][index]}`,\n                hintContent: `${item[0]}: <b>${w.data.values[1][index]}</b> шт.`,\n                iconContent: `${item[0]}: <b>${w.data.values[1][index]}</b> шт.`\n        }, {\n                preset: 'islands#blueStretchyIcon'\n            }));\n        });\n        myPlacemarks.forEach (item => myMap.geoObjects.add(item));\n        \n    });\n}\n\nif (typeof(ymaps) === 'object') {\n    init();\n}\n\n({\n    isLoaded: function(){\n        return loadedPromise\n    }\n})","dataSettings":{"datasourceType":4,"tableData":"[[\"\",\"Объём продаж\",\"Широта\",\"Долгота\"],[\"Германия\",\"32452.2\",\"52.5207399\",\"13.3783318\"],[\"Республика Беларусь\",\"22022.6\",\"53.9023340\",\"27.5618791\"],[\"Польша\",\"12352.9\",\"52.2319581\",\"21.0067249\"],[\"Франция\",\"12177.5\",\"48.8566969\",\"2.3514616\"],[\"Италия\",\"11337.7\",\"41.8933203\",\"12.4829321\"],[\"Чили\",\"10627.1\",\"-33.4377968\",\"-70.6504451\"],[\"Россия\",\"38936.4\",\"55.753994\",\"37.622093\"]]","olapSettings":{"impacts":[],"olapGroups":[],"limit":{"rowsLimit":100,"columnsLimit":10},"useLimit":true,"defaultSelectedValuesSettings":{"mode":0,"from":{"offsetPeriod":0,"dateStartingPointType":1,"relativeDateRangeType":1,"offset":0},"to":{"offsetPeriod":0,"dateStartingPointType":1,"relativeDateRangeType":1,"offset":0},"selectedValuesCount":1}},"rawOlapSettings":{"measureGroup":{"id":null,"columns":[],"filters":[]}},"pythonSettings":{"scriptId":null,"variableName":null,"impactsOnWidgetsEnabled":false},"csSettings":{"scriptId":null,"variableName":null,"impactsOnWidgetsEnabled":false},"calculatedColumnsSettings":{"calculatedColumns":[]},"columnsVisibilitySettings":{"mode":0,"enabled":false,"cols":[]},"nullValueHandlingSettings":{"nullToZero":false,"hideEmptyRows":false,"hideEmptyColumns":false},"factorAnalysisSettings":{"target":null,"factors":[],"l1":0.5,"l2":0.5,"dataTrainTestSegregation":0.5,"model":null}},"themeGuid":null,"numberFormat":{"precision":null,"useGrouping":null,"groupSeparator":null}},{"contentTextStyle":{"color":null,"fontSize":null,"fontFamily":null,"align":0,"verticalAlign":null,"lineHeight":1.3,"isBold":null,"isItalic":null},"contentText":"YandexMaps Minimal <br><br>\r\nПример использования библиотеки YandexMaps для визуализации данных на геокарте. Реализован минимальный функционал. Особенность: работает только при отключенном масштабировании дашборда!!!","guid":"b7baf30f7f0049b184e074286f2b474e","type":"TextWidget","position":{"x":0,"y":0},"positionLocked":false,"size":{"width":1920,"height":120},"title":{"enabled":false,"autoSize":null,"text":"Текст 1 - копия","link":"","linkEnabled":null,"background":{"enabled":null,"color":{"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"textStyle":{"color":null,"fontSize":null,"fontFamily":null,"align":null,"verticalAlign":null,"lineHeight":null,"isBold":null,"isItalic":null},"size":{"width":null,"height":null}},"frame":{"enabled":null,"style":{"radius":null,"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"background":{"enabled":null,"color":{"colorType":null,"color":null,"gradientColor":{"colorStart":null,"colorEnd":null}}},"boxShadow":{"x":null,"y":null,"blur":null,"spread":null,"color":null},"zIndex":2,"selectedFilterValues":{"values":[],"range":{"min":null,"max":null},"useRange":false,"useExcluding":false},"multiselectEnabled":true,"userChangedSelectedValuesInCurrentSession":false,"colorPalette":null,"useCustomColors":false,"drilldownEnabled":false,"allowedDatasourceType":[2,3,4,5,6],"codeEditableEnabled":false,"overriddenCode":null,"dataSettings":{"datasourceType":5,"tableData":"[[\"\",\"Серия 1\",\"Серия 2\",\"Серия 3\"],[\"Значение 1\",\"100\",\"400\",\"200\"],[\"Значение 2\",\"50\",\"700\",\"250\"],[\"Значение 3\",\"300\",\"0\",\"100\"]]","olapSettings":{"impacts":[],"olapGroups":[],"limit":{"rowsLimit":100,"columnsLimit":10},"useLimit":true,"defaultSelectedValuesSettings":{"mode":0,"from":{"offsetPeriod":0,"dateStartingPointType":1,"relativeDateRangeType":1,"offset":0},"to":{"offsetPeriod":0,"dateStartingPointType":1,"relativeDateRangeType":1,"offset":0},"selectedValuesCount":1}},"rawOlapSettings":{"measureGroup":{"id":null,"columns":[],"filters":[]}},"pythonSettings":{"scriptId":null,"variableName":null,"impactsOnWidgetsEnabled":false},"csSettings":{"scriptId":null,"variableName":null,"impactsOnWidgetsEnabled":false},"calculatedColumnsSettings":{"calculatedColumns":[]},"columnsVisibilitySettings":{"mode":0,"enabled":false,"cols":[]},"nullValueHandlingSettings":{"nullToZero":false,"hideEmptyRows":false,"hideEmptyColumns":false},"factorAnalysisSettings":{"target":null,"factors":[],"l1":0.5,"l2":0.5,"dataTrainTestSegregation":0.5,"model":null}},"themeGuid":null,"numberFormat":{"precision":null,"useGrouping":null,"groupSeparator":null}}],"size":{"width":1920,"height":1080},"fit":1,"color":"rgba(255,255,255,1)"}],"roles":[{"name":"Администратор"}],"users":[],"grantedPublicAccess":false,"grid":{"enabled":false},"viQubeDatabaseId":"ViQube","guid":"01b0ef6356ce4692861133e95fc22637"}]